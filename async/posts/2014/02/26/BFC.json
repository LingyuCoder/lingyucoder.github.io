{"tags":[{"name":"CSS","permalink":"http://lingyu.life/tags/CSS/","url":"/async/tags/CSS.json","count":30}],"categories":[{"name":"CSS","permalink":"http://lingyu.life/categories/CSS/","url":"/async/categories/CSS.json","count":8}],"url":"/async/posts/2014/02/26/BFC.json","date":1393344000000,"path":{"year":2014,"month":2,"day":26,"name":"BFC"},"subtitle":"什么是BFC？它如何出现、又干了些什么？","title":"深入浅出BFC（Block formatting contexts）","permalink":"http://lingyu.life/2014/02/26/BFC/","content":"<p>BFC（Block formatting contexts）,是W3C CSS 2.1中的一个概念，决定了元素如何对其内容进行定位，以及与其他元素的关系和相互作用。在创建了BFC的元素中，子元素会一个接一个的被放置…</p>\n<a id=\"more\"></a>\n\n<h2 id=\"何为BFC\"><a href=\"#何为BFC\" class=\"headerlink\" title=\"何为BFC\"></a>何为BFC</h2><p>BFC（Block formatting contexts）,是W3C CSS 2.1中的一个概念，决定了元素如何对其内容进行定位，以及与其他元素的关系和相互作用。在创建了BFC的元素中，子元素会一个接一个的被放置。垂直方向上，他们的起点是一个包含块的顶部，两个相邻元素之间的垂直距离取决于<code>margin</code>特性。BFC中相邻的块级元素的垂直边距(<code>margin-top</code>和<code>margin-bottom</code>)会被折叠（collapse）。在BFC中，每一个元素的左边与包含块的左边（<code>border-left</code>）相接触（如果从右到左的格式化，右边接触包含块的<code>border-right</code>），除非这个元素也创建了一个BFC。</p>\n<h2 id=\"触发BFC\"><a href=\"#触发BFC\" class=\"headerlink\" title=\"触发BFC\"></a>触发BFC</h2><p>满足以下任意一个情况就会触发BFC：</p>\n<ul>\n<li>根节点</li>\n<li>浮动（<code>float</code>不为<code>none</code>）</li>\n<li>绝对定位元素（<code>position</code>为<code>absolute</code>或<code>fixed</code>）</li>\n<li><code>display: inline-block</code>的元素</li>\n<li><code>display: table-cell</code>的元素（HTML的table格子默认就是这个）</li>\n<li><code>display: table-caption</code>的元素(HTML的table caption默认就是这个)</li>\n<li><code>overflow</code>不为<code>visible</code>的元素</li>\n<li>伸缩盒元素（<code>display</code>为<code>flex</code>或<code>inline-flex</code>）</li>\n</ul>\n<h2 id=\"BFC的作用\"><a href=\"#BFC的作用\" class=\"headerlink\" title=\"BFC的作用\"></a>BFC的作用</h2><p>BFC的主要知识点在清除浮动重叠与margin重叠上，margin重叠有如下规则：</p>\n<ul>\n<li>两个相邻的外边距都是正数时，折叠结果是它们两者之间较大的值</li>\n<li>两个相邻的外边距都是负数时，折叠结果是两者绝对值的较大值</li>\n<li>两个外边距一正一负时，折叠结果是两者的相加的和</li>\n</ul>\n<h2 id=\"BFC清除嵌套元素的margin重叠\"><a href=\"#BFC清除嵌套元素的margin重叠\" class=\"headerlink\" title=\"# BFC清除嵌套元素的margin重叠\"></a># BFC清除嵌套元素的margin重叠</h2><p>如果父元素不触发BFC，</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"outer\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"inner\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>CSS代码如下：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.outer</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>: <span class=\"number\">#f0f0f0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.inner</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: blue;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>效果图：</p>\n<p><img src=\"/img/BFC/1.png\" alt=\"不触发BFC时垂直margin重叠\"></p>\n<p>可以看到，子元素inner和父元素outer的<code>margin-top</code>重叠了</p>\n<p>在outer上触发BFC，修改CSS：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.outer</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>: <span class=\"number\">#f0f0f0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.inner</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">margin-top</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: blue;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>效果图：<br><img src=\"/img/BFC/2.png\" alt=\"触发BFC后垂直margin不重叠\"></p>\n<p>在触发了父元素的BFC，于是乎margin不再重叠</p>\n<h2 id=\"不与浮动元素重叠\"><a href=\"#不与浮动元素重叠\" class=\"headerlink\" title=\"# 不与浮动元素重叠\"></a># 不与浮动元素重叠</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"outer\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"left\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"top\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.outer</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>: <span class=\"number\">#f0f0f0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.left</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: blue;</span><br><span class=\"line\">\t\t<span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.top</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: red;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>效果图：</p>\n<p><img src=\"/img/BFC/3.png\" alt=\"两个矩形重叠\"></p>\n<p><img src=\"/img/BFC/4.png\" alt=\"检索left元素\"></p>\n<p><img src=\"/img/BFC/5.png\" alt=\"检索top元素\"></p>\n<p>可以从上面三张图看到，两个长方形被重叠了</p>\n<p>在非浮动元素（top）上触发BFC，修改CSS:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.outer</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>: <span class=\"number\">#f0f0f0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.left</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: blue;</span><br><span class=\"line\">\t\t<span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.top</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">200px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: red;</span><br><span class=\"line\">\t\t<span class=\"attribute\">overflow</span>:hidden;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>效果图：</p>\n<p><img src=\"/img/BFC/6.png\" alt=\"浮动元素与非浮动元素不再重叠\"></p>\n<p>两个矩形不再重叠，不过需要注意在非浮动元素上触发BFC</p>\n<h2 id=\"清除元素内部浮动\"><a href=\"#清除元素内部浮动\" class=\"headerlink\" title=\"# 清除元素内部浮动\"></a># 清除元素内部浮动</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"outer\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"left\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"right\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.outer</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>: <span class=\"number\">#f0f0f0</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.left</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: blue;</span><br><span class=\"line\">\t\t<span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"selector-class\">.outer</span> <span class=\"selector-class\">.right</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">\t\t<span class=\"attribute\">background-color</span>: red;</span><br><span class=\"line\">\t\t<span class=\"attribute\">float</span>: right;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n<p>效果图：</p>\n<p><img src=\"/img/BFC/7.png\" alt=\"outer没有被浮动元素撑开\"></p>\n<p>可以看到，outer并没有被撑开，查看元素发现其高度为0px</p>\n<p>修改css在outer上触发BFC：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.outer &#123;</span><br><span class=\"line\">\tbackground-color: #f0f0f0;</span><br><span class=\"line\">\twidth: 100%;</span><br><span class=\"line\">\toverflow: hidden;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t.outer .left &#123;</span><br><span class=\"line\">\t\twidth: 100px;</span><br><span class=\"line\">\t\theight: 100px;</span><br><span class=\"line\">\t\tbackground-color: blue;</span><br><span class=\"line\">\t\tfloat: left;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t.outer .right &#123;</span><br><span class=\"line\">\t\twidth: 100px;</span><br><span class=\"line\">\t\theight: 100px;</span><br><span class=\"line\">\t\tbackground-color: red;</span><br><span class=\"line\">\t\tfloat: right;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n<p>效果图：</p>\n<p><img src=\"/img/BFC/8.png\" alt=\"触发BFC后outer被浮动元素撑开\"></p>\n<p>在outer上触发BFC后可以看到，outer的高度变成了100px，被left和right两个浮动元素撑开了</p>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Block_formatting_context\" target=\"_blank\" rel=\"noopener\">Block formatting context</a></p>\n"}